(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user-center"],{"153a":function(t,i,s){"use strict";s.r(i);s("b0c0");var n=function(){var t=this,i=t._self._c;return i("div",{staticClass:"panel main pd2"},[i("div",{staticClass:"msg"},[t._v("Hi, Admin，你已经是我们的正式会员！")]),i("div",{staticClass:"layui-row layui-col-space20"},[i("div",{staticClass:"layui-col-md6"},[i("div",{staticClass:"panel border"},[i("div",{staticClass:"title"},[t._v("我的会员信息")]),i("div",{staticClass:"content fly-signin"},[i("p",[t._v(" 积分经验值： "),i("cite",[t._v(t._s(t.userInfo.favs))])]),i("p",[t._v(" 您当前为: "),i("cite",[t._v(t._s("0"===t.userInfo.isVip?"非VIP":"VIP"+t.userInfo.isVip))])])])])]),i("div",{staticClass:"layui-col-md6"},[i("sign",{staticClass:"border"})],1),i("div",{staticClass:"layui-col-md12 mt20"},[i("div",{staticClass:"panel border"},[i("div",{staticClass:"title"},[t._v("快捷方式")]),i("div",{staticClass:"content",staticStyle:{height:"auto"}},[i("ul",{staticClass:"layui-row layui-col-space10"},t._l(t.lists,(function(s,n){return i("li",{key:"user-center"+n,staticClass:"layui-col-sm3 layui-col-xs4"},[i("router-link",{attrs:{to:{name:s.route}}},[i("div",{staticClass:"layui-icon shortcut",class:s.icon}),i("span",[t._v(t._s(s.name))])])],1)})),0)])])])])])},a=[],e=s("c24f"),o=s("cddc"),c={name:"user-center",components:{Sign:o["a"]},data:function(){return{lists:[{name:"修改信息",route:"info",icon:"layui-icon-set"},{name:"修改头像",route:"pic",icon:"layui-icon-face-smile"},{name:"修改密码",route:"passwd",icon:"layui-icon-password"},{name:"账号绑定",route:"account",icon:"layui-icon-app"},{name:"发表新贴",route:"",icon:"layui-icon-add-circle"},{name:"查看分享",route:"",icon:"layui-icon-share"},{name:"我的帖子",route:"mypost",icon:"layui-icon-username"},{name:"我的收藏",route:"mycollection",icon:"layui-icon-rate-solid"},{name:"其他资料",route:"",icon:"layui-icon-template-1"},{name:"关注公众号",route:"",icon:"layui-icon-login-wechat"},{name:"文档",route:"",icon:"layui-icon-read"},{name:"后台管理",route:"",icon:"layui-icon-user"}]}},computed:{userInfo:function(){return this.$store.state.userInfo}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var t=this;Object(e["f"])({uid:this.userInfo._id}).then((function(i){200===i.code&&t.$store.commit("setUserInfo",i.data)}))}}},r=c,u=(s("f3f0"),s("2877")),l=Object(u["a"])(r,n,a,!1,null,"527726b6",null);i["default"]=l.exports},"2b8b":function(t,i,s){},"92f1":function(t,i,s){"use strict";s("c4ff")},b1db:function(t,i,s){},c24f:function(t,i,s){"use strict";s.d(i,"m",(function(){return c})),s.d(i,"k",(function(){return r})),s.d(i,"l",(function(){return u})),s.d(i,"b",(function(){return l})),s.d(i,"a",(function(){return f})),s.d(i,"d",(function(){return d})),s.d(i,"h",(function(){return v})),s.d(i,"c",(function(){return g})),s.d(i,"f",(function(){return y})),s.d(i,"e",(function(){return m})),s.d(i,"i",(function(){return h})),s.d(i,"g",(function(){return p})),s.d(i,"j",(function(){return _}));var n=s("5530"),a=s("b775"),e=s("4328"),o=s.n(e),c=function(){return a["a"].get("/user/fav")},r=function(t){return a["a"].post("/user/basic",t)},u=function(t){return a["a"].get("/public/resetEmail?"+o.a.stringify(t))},l=function(t){return a["a"].post("/user/changePassword",Object(n["a"])({},t))},f=function(t){return a["a"].get("/user/setCollect?"+o.a.stringify(t))},d=function(t){return a["a"].get("/user/collect?"+o.a.stringify(t))},v=function(t){return a["a"].get("/user/post?"+o.a.stringify(t))},h=function(t){return a["a"].get("/public/latestPost?"+o.a.stringify(t))},g=function(t){return a["a"].get("/user/deletePost?"+o.a.stringify(t))},y=function(t){return a["a"].get("/public/info?"+o.a.stringify(t))},m=function(t){return a["a"].get("/public/latestComment?"+o.a.stringify(t))},p=function(t){return a["a"].get("/user/getmsg?"+o.a.stringify(t))},_=function(t){return a["a"].get("/user/setmsg?"+o.a.stringify(t))}},c4ff:function(t,i,s){},c759:function(t,i,s){"use strict";s("2b8b")},cddc:function(t,i,s){"use strict";var n=function(){var t=this,i=t._self._c;return i("div",{staticClass:"fly-panel fly-signin"},[i("div",{staticClass:"fly-panel-title"},[t._v(" 签到 "),i("i",{staticClass:"fly-mid"}),i("a",{staticClass:"fly-link",attrs:{href:"javascript:;",id:"LAY_signinHelp"},on:{click:function(i){return t.showInfo()}}},[t._v("说明")]),i("i",{staticClass:"fly-mid"}),i("a",{staticClass:"fly-link",attrs:{href:"javascript:;",id:"LAY_signinTop"},on:{click:function(i){return t.showTop()}}},[t._v(" 活跃榜 "),i("span",{staticClass:"layui-badge-dot"})]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isSign||t.isLogin,expression:"isSign || isLogin"}],staticClass:"fly-signin-days"},[t._v(" 已连续签到 "),i("cite",[t._v(t._s(t.count))]),t._v("天 ")])]),i("div",{staticClass:"fly-panel-main fly-signin-main"},[t.isSign?[i("button",{staticClass:"layui-btn layui-btn-disabled"},[t._v(t._s(t.msg))]),i("span",[t._v(" 获得了 "),i("cite",[t._v(t._s(t.favs))]),t._v("飞吻 ")])]:[i("button",{staticClass:"layui-btn layui-btn-danger",attrs:{id:"LAY_signin"},on:{click:function(i){return t.sign()}}},[t._v("今日签到")]),i("span",[t._v(" 可获得 "),i("cite",[t._v(t._s(t.favs))]),t._v("飞吻 ")])]],2),i("sign-info",{attrs:{isShow:t.isShow},on:{closeModal:function(i){return t.close()}}}),i("sign-list",{attrs:{isShow:t.showList},on:{closeModal:function(i){return t.close()}}})],1)},a=[],e=(s("99af"),function(){var t=this,i=t._self._c;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"modal"},[i("div",{staticClass:"mask",on:{click:function(i){return t.close()}}}),i("div",{staticClass:"layui-layer layui-layer-page",class:{active:t.isShow}},[i("div",{staticClass:"layui-layer-title"},[t._v(" 签到说明 "),i("i",{staticClass:"layui-icon layui-icon-close pull-right",on:{click:function(i){return t.close()}}})]),t._m(0)])])}),o=[function(){var t=this,i=t._self._c;return i("div",{staticClass:"layui-layer-content"},[i("div",{staticClass:"layui-text"},[i("blockquote",{staticClass:"layui-elem-quote"},[t._v("“签到”可获得的社区积分，规则如下")]),i("table",{staticClass:"layui-table"},[i("thead",[i("tr",[i("th",[t._v("连续签到天数")]),i("th",[t._v("每天可获积分")])])]),i("tbody",[i("tr",[i("td",[t._v("<5")]),i("td",[t._v("5")])]),i("tr",[i("td",[t._v("≥5")]),i("td",[t._v("10")])]),i("tr",[i("td",[t._v("≥15")]),i("td",[t._v("15")])]),i("tr",[i("td",[t._v("≥30")]),i("td",[t._v("20")])]),i("tr",[i("td",[t._v("≥100")]),i("td",[t._v("30")])]),i("tr",[i("td",[t._v("≥365")]),i("td",[t._v("50")])])])]),i("div",[i("p",[t._v("中间若有间隔，则连续天数重新计算")]),i("p",{staticClass:"orange"},[t._v("不可复用程序自动签到，否则积分清零")])])])])}],c={name:"sign-info",props:{isShow:{default:!1,type:Boolean}},methods:{close:function(){this.$emit("closeModal")}}},r=c,u=s("2877"),l=Object(u["a"])(r,e,o,!1,null,"0b15a566",null),f=l.exports,d=(s("b0c0"),function(){var t=this,i=t._self._c;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"modal"},[i("div",{staticClass:"mask",on:{click:function(i){return t.close()}}}),i("div",{staticClass:"layui-layer layui-layer-page",class:{active:t.isShow}},[i("div",{staticClass:"layui-layer-title"},[t._v(" 签到活跃榜 - TOP "),i("i",{staticClass:"layui-icon layui-icon-close pull-right",on:{click:function(i){return t.close()}}})]),i("div",{staticClass:"layui-layer-content pd0"},[i("div",{staticClass:"layui-tab layui-tab-brief"},[i("ul",{staticClass:"layui-tab-title"},[i("li",{class:{"layui-this":2===t.current},on:{click:function(i){return t.choose(2)}}},[t._v("最新签到")]),i("li",{class:{"layui-this":1===t.current},on:{click:function(i){return t.choose(1)}}},[t._v("今日最快")]),i("li",{class:{"layui-this":0===t.current},on:{click:function(i){return t.choose(0)}}},[t._v("总签到榜")])]),i("div",{staticClass:"layui-tab-content fly-signin-list"},[i("ul",{staticClass:"layui-tab-item layui-show"},t._l(t.lists,(function(s,n){return i("li",{key:"sign"+n,staticClass:"sign-item"},[0===t.current?i("img",{staticClass:"mr1",attrs:{src:s.pic?s.pic:"/img/bear-200-200.jpg",alt:""}}):i("img",{staticClass:"mr1",attrs:{src:s.uid?s.uid.pic:"/img/bear-200-200.jpg"}}),i("cite",{staticClass:"fly-link"},[t._v(t._s(s.name?s.name:s.uid.name))]),0!==t.current?i("span",{staticClass:"fly-grey"},[t._v("签到于 "+t._s(t._f("hours")(s.created)))]):i("span",{staticClass:"fly-grey"},[t._v(" 已经连续签到 "),i("i",{staticClass:"orange"},[t._v(t._s(s.count))]),t._v("天 ")])])})),0)])])])])])}),v=[],h=s("b775"),g=s("4328"),y=s.n(g),m=function(t){return h["a"].get("/public/hotSignRecord?"+y.a.stringify(t))},p={name:"sign-list",props:{isShow:{default:!1,type:Boolean}},data:function(){return{current:0,lists:[],limit:20,page:0}},mounted:function(){this.getList()},methods:{choose:function(t){this.current=t,this.getList()},close:function(){this.$emit("closeModal")},getList:function(){var t=this;m({page:this.page,limit:this.limit,index:this.current}).then((function(i){200===i.code&&(t.lists=i.data)}))}}},_=p,C=(s("c759"),Object(u["a"])(_,d,v,!1,null,"055db4bf",null)),b=C.exports,w=s("c24f"),S=s("5a0c"),I=s.n(S),k={name:"sign",components:{SignInfo:f,SignList:b},data:function(){return{isShow:!1,showList:!1,current:0,isSign:!1,msg:"",ctrl:""}},mounted:function(){var t=this.$store.state.userInfo.isSign,i=this.$store.state.userInfo.lastSign,s=I()().format("YYYY-MM-DD"),n=I()(i).format("YYYY-MM-DD"),a=I()(s).diff(I()(n),"day");a>0&&t?this.isSign=!1:(this.isSign=t,0===a&&t?this.nextSign():this.msg="今日已签到")},watch:{userInfo:function(t,i){!0===t.isSign?(this.nextSign(),this.isSign=!0):this.isSign=!1}},computed:{userInfo:function(){return this.$store.state.userInfo},isLogin:function(){return this.$store.state.isLogin},favs:function(){var t=parseInt(this.count),i=0;return t<5?i=5:t>=5&&t<15?i=10:t>=15&&t<30?i=15:t>=30&&t<100?i=20:t>=100&&t<365?i=30:t>=365&&(i=50),i},count:function(){return this.$store.state.userInfo!=={}&&"undefined"!==typeof this.$store.state.userInfo.count?this.$store.state.userInfo.count:0}},methods:{nextSign:function(){var t=this;clearInterval(this.ctrl);var i=I()().add(1,"day").format("YYYY-MM-DD"),s=I()(i+" 00:00:00").diff(I()(),"second"),n=Math.floor(s/3600),a=Math.floor(s%3600/60),e=s%60;this.msg="签到倒计时 ".concat(n,":").concat(a<10?"0"+a:a,":").concat(e<10?"0"+e:e),this.ctrl=setInterval((function(){if(s=I()(i+" 00:00:00").diff(I()(),"second"),n=Math.floor(s/3600),a=Math.floor(s%3600/60),e=s%60,t.msg="签到倒计时 ".concat(n,":").concat(a<10?"0"+a:a,":").concat(e<10?"0"+e:e),s<=0){clearInterval(t.ctrl),t.isSign=!1;var o=t.$store.state.userInfo;o.isSign=!1,t.$store.commit("setUserInfo",o)}}),1e3)},showInfo:function(){this.isShow=!0},showTop:function(){this.showList=!0},close:function(){this.isShow=!1,this.showList=!1},choose:function(t){this.current=t},sign:function(){var t=this;this.isLogin?(Object(w["m"])().then((function(i){var s=t.$store.state.userInfo;200===i.code?(s.favs=i.favs,s.count=i.count,t.$pop("","签到成功！")):t.$pop("","您已经签到！"),s.isSign=!0,s.lastSign=i.lastSign,t.isSign=!0,t.$store.commit("setUserInfo",s)})),this.nextSign()):this.$pop("shake","请先登录")}}},$=k,L=(s("92f1"),Object(u["a"])($,n,a,!1,null,null,null));i["a"]=L.exports},f3f0:function(t,i,s){"use strict";s("b1db")}}]);