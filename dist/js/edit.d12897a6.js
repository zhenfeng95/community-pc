(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["edit"],{"2c52":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"layui-container fly-marginTop",class:{"d-hide":t.isHide}},[a("div",{staticClass:"fly-panel",staticStyle:{"padding-top":"5px"},attrs:{pad20:""}},[a("div",{staticClass:"layui-form layui-form-pane"},[a("div",{staticClass:"layui-tab layui-tab-brief",attrs:{"lay-filter":"user"}},[t._m(0),a("div",{staticClass:"layui-form layui-tab-content",staticStyle:{padding:"20px 0"},attrs:{id:"LAY_ucm"}},[a("div",{staticClass:"layui-tab-item layui-show"},[a("form",[a("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var i=e.validate;return[a("div",{staticClass:"layui-row layui-col-space15 layui-form-item"},[a("div",{staticClass:"layui-col-md3"},[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label"},[t._v("所在专栏")]),a("div",{staticClass:"layui-input-block"},[a("div",{staticClass:"layui-unselect layui-form-select"},[a("div",{staticClass:"layui-select-title"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.catalogs[t.cataIndex].text,expression:"catalogs[cataIndex].text"}],staticClass:"layui-input layui-unselect layui-disabled",attrs:{type:"text",placeholder:"请选择",readonly:""},domProps:{value:t.catalogs[t.cataIndex].text},on:{input:function(a){a.target.composing||t.$set(t.catalogs[t.cataIndex],"text",a.target.value)}}}),a("i",{staticClass:"layui-edge"})])])])])]),a("div",{staticClass:"layui-col-md9"},[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label",attrs:{for:"L_title"}},[t._v("标题")]),a("div",{staticClass:"layui-input-block"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"layui-input",attrs:{type:"text"},domProps:{value:t.title},on:{input:function(a){a.target.composing||(t.title=a.target.value)}}})])])])]),a("editor",{attrs:{initContent:t.content},on:{changeContent:t.add}}),a("div",{staticClass:"layui-form-item"},[a("div",{staticClass:"layui-inline"},[a("label",{staticClass:"layui-form-label"},[t._v("悬赏飞吻")]),a("div",{staticClass:"layui-input-inline",staticStyle:{width:"190px"}},[a("div",{staticClass:"layui-unselect layui-form-select"},[a("div",{staticClass:"layui-select-title"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.favList[t.favIndex],expression:"favList[favIndex]"}],staticClass:"layui-input layui-unselect layui-disabled",attrs:{type:"text",placeholder:"请选择",readonly:""},domProps:{value:t.favList[t.favIndex]},on:{input:function(a){a.target.composing||t.$set(t.favList,t.favIndex,a.target.value)}}}),a("i",{staticClass:"layui-edge"})])])]),a("div",{staticClass:"layui-form-mid layui-word-aux"},[t._v("发表后无法更改飞吻")])])]),a("div",{staticClass:"layui-form-item"},[a("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),a("div",{staticClass:"layui-input-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(a){a.target.composing||(t.code=a.target.value)}}})]),a("div",{},[a("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(a){return t._getCode()}}})])]),a("div",{staticClass:"layui-form-mid"},[a("span",{staticStyle:{color:"#c00"}},[t._v(t._s(i[0]))])])]}}],null,!0)})],1),a("div",{staticClass:"layui-form-item"},[a("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(a){i().then(t.submit)}}},[t._v("立即发布")])])]}}])})],1)])])])])])])},s=[function(){var t=this,a=t._self._c;return a("ul",{staticClass:"layui-tab-title"},[a("li",{staticClass:"layui-this"},[t._v("编辑帖子")])])}],l=e("c14f"),n=e("1da1"),c=e("5530"),o=(e("4de4"),e("14d9"),e("e9f5"),e("910d"),e("e9c4"),e("b64b"),e("d3b7"),e("498a"),e("cc48")),r=e("81b3"),u=e("32d8"),d={name:"Edit",props:["tid","page"],mixins:[r["a"]],components:{Editor:u["a"]},data:function(){return{cataIndex:0,favIndex:0,catalogs:[{text:"请选择",value:""},{text:"提问",value:"ask"},{text:"分享",value:"share"},{text:"讨论",value:"discuss"},{text:"建议",value:"advise"}],favList:[20,30,50,60,80],content:"",title:""}},mounted:function(){var t=this;if(this.page)this.content=this.page.content,this.title=this.page.title,this.favIndex=this.favList.indexOf(parseInt(this.page.fav)),this.cataIndex=this.catalogs.indexOf(this.catalogs.filter((function(a){return a.value===t.page.catalog}))[0]),localStorage.setItem("editData",JSON.stringify(this.page));else{var a=localStorage.getItem("editData");a&&""!==a&&this.$confirm("是否加载未编辑完的内容？",(function(){var e=JSON.parse(a);t.content=e.content,t.title=e.title,t.cataIndex=e.cataIndex,t.favIndex=e.favIndex}),(function(){localStorage.setItem("editData","")}))}},methods:{chooseCatalog:function(t,a){this.cataIndex=a},chooseFav:function(t,a){this.favIndex=a},changeSelect:function(){this.isSelect=!this.isSelect},changeFav:function(){this.isSelect_fav=!this.isSelect_fav},add:function(t){this.content=t;var a={title:this.title,cataIndex:this.cataIndex,content:this.content,favIndex:this.favIndex};if(""!==this.title.trim()&&""!==this.content.trim()){var e=localStorage.getItem("editData"),i={};e&&""!==e&&(i=Object(c["a"])(Object(c["a"])({},a),JSON.parse(e))),localStorage.setItem("editData",JSON.stringify(i))}},submit:function(){var t=this;return Object(n["a"])(Object(l["a"])().m((function a(){var e;return Object(l["a"])().w((function(a){while(1)switch(a.n){case 0:return a.n=1,t.$refs.observer.validate();case 1:if(e=a.v,e){a.n=2;break}return a.a(2);case 2:if(""!==t.content.trim()){a.n=3;break}return t.$alert("文章内容不得为空！"),a.a(2);case 3:Object(o["g"])({tid:t.tid,title:t.title,content:t.content,code:t.code,sid:t.$store.state.sid}).then((function(a){200===a.code?(localStorage.setItem("editData",""),t.$pop("","更新成功!"),setTimeout((function(){t.$router.push({name:"detail",params:{tid:t.tid}})}),1e3)):t.$alert(a.msg)}));case 4:return a.a(2)}}),a)})))()}},computed:{isHide:function(){return this.$store.state.isHide}}},v=d,f=e("2877"),m=Object(f["a"])(v,i,s,!1,null,"0f4a41b6",null);a["default"]=m.exports}}]);