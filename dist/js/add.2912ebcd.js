(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["add"],{"1af0":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"layui-container fly-marginTop",class:{"d-hide":t.isHide}},[a("div",{staticClass:"fly-panel",staticStyle:{"padding-top":"5px"},attrs:{pad20:""}},[a("div",{staticClass:"layui-form layui-form-pane"},[a("div",{staticClass:"layui-tab layui-tab-brief",attrs:{"lay-filter":"user"}},[t._m(0),a("div",{staticClass:"layui-form layui-tab-content",staticStyle:{padding:"20px 0"},attrs:{id:"LAY_ucm"}},[a("div",{staticClass:"layui-tab-item layui-show"},[a("form",[a("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var i=e.validate;return[a("div",{staticClass:"layui-row layui-col-space15 layui-form-item"},[a("div",{staticClass:"layui-col-md3"},[a("validation-provider",{attrs:{name:"catalog",rules:"is_not:请选择"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label"},[t._v("所在专栏")]),a("div",{staticClass:"layui-input-block",on:{click:function(a){return t.changeSelect()}}},[a("div",{staticClass:"layui-unselect layui-form-select",class:{"layui-form-selected":t.isSelect}},[a("div",{staticClass:"layui-select-title"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.catalogs[t.cataIndex].text,expression:"catalogs[cataIndex].text"}],staticClass:"layui-input layui-unselect",attrs:{type:"text",placeholder:"请选择",readonly:""},domProps:{value:t.catalogs[t.cataIndex].text},on:{input:function(a){a.target.composing||t.$set(t.catalogs[t.cataIndex],"text",a.target.value)}}}),a("i",{staticClass:"layui-edge"})]),a("dl",{staticClass:"layui-anim layui-anim-upbit"},t._l(t.catalogs,(function(e,i){return a("dd",{key:"catalog"+i,class:{"layui-this":i===t.cataIndex},on:{click:function(a){return t.chooseCatalog(e,i)}}},[t._v(t._s(e.text))])})),0)])])]),a("div",{staticClass:"layui-row"},[a("span",{staticStyle:{color:"#c00"}},[t._v(t._s(i[0]))])])]}}],null,!0)})],1),a("div",{staticClass:"layui-col-md9"},[a("validation-provider",{attrs:{name:"title",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label",attrs:{for:"L_title"}},[t._v("标题")]),a("div",{staticClass:"layui-input-block"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"layui-input",attrs:{type:"text"},domProps:{value:t.title},on:{input:function(a){a.target.composing||(t.title=a.target.value)}}})])]),a("div",{staticClass:"layui-row"},[a("span",{staticStyle:{color:"#c00"}},[t._v(t._s(i[0]))])])]}}],null,!0)})],1)]),a("editor",{attrs:{initContent:t.content},on:{changeContent:t.add}}),a("div",{staticClass:"layui-form-item"},[a("div",{staticClass:"layui-inline"},[a("label",{staticClass:"layui-form-label"},[t._v("悬赏飞吻")]),a("div",{staticClass:"layui-input-inline",staticStyle:{width:"190px"}},[a("div",{staticClass:"layui-unselect layui-form-select",class:{"layui-form-selected":t.isSelect_fav},on:{click:function(a){return t.changeFav()}}},[a("div",{staticClass:"layui-select-title"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.favList[t.favIndex],expression:"favList[favIndex]"}],staticClass:"layui-input layui-unselect",attrs:{type:"text",placeholder:"请选择",readonly:""},domProps:{value:t.favList[t.favIndex]},on:{input:function(a){a.target.composing||t.$set(t.favList,t.favIndex,a.target.value)}}}),a("i",{staticClass:"layui-edge"})]),a("dl",{staticClass:"layui-anim layui-anim-upbit"},t._l(t.favList,(function(e,i){return a("dd",{key:"catalog"+i,class:{"layui-this":i===t.favIndex},on:{click:function(a){return t.chooseFav(e,i)}}},[t._v(t._s(e))])})),0)])]),a("div",{staticClass:"layui-form-mid layui-word-aux"},[t._v("发表后无法更改飞吻")])])]),a("div",{staticClass:"layui-form-item"},[a("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("div",{staticClass:"layui-row"},[a("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),a("div",{staticClass:"layui-input-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(a){a.target.composing||(t.code=a.target.value)}}})]),a("div",{},[a("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(a){return t._getCode()}}})])]),a("div",{staticClass:"layui-form-mid"},[a("span",{staticStyle:{color:"#c00"}},[t._v(t._s(i[0]))])])]}}],null,!0)})],1),a("div",{staticClass:"layui-form-item"},[a("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(a){i().then(t.submit)}}},[t._v("立即发布")])])]}}])})],1)])])])])])])},s=[function(){var t=this,a=t._self._c;return a("ul",{staticClass:"layui-tab-title"},[a("li",{staticClass:"layui-this"},[t._v(" 发表新帖 ")])])}],l=e("c14f"),n=e("1da1"),c=(e("14d9"),e("e9c4"),e("b64b"),e("498a"),e("cc48")),o=e("81b3"),r=e("32d8"),u={name:"add",mixins:[o["a"]],components:{Editor:r["a"]},data:function(){return{isSelect:!1,isSelect_fav:!1,cataIndex:0,favIndex:0,catalogs:[{text:"请选择",value:""},{text:"提问",value:"ask"},{text:"分享",value:"share"},{text:"讨论",value:"discuss"},{text:"建议",value:"advise"}],favList:[20,30,50,60,80],content:"",title:""}},mounted:function(){var t=this,a=localStorage.getItem("addData");a&&""!==a&&this.$confirm("是否加载未编辑完的内容？",(function(){var e=JSON.parse(a);t.content=e.content,t.title=e.title,t.cataIndex=e.cataIndex,t.favIndex=e.favIndex}),(function(){localStorage.setItem("addData","")}))},methods:{chooseCatalog:function(t,a){this.cataIndex=a},chooseFav:function(t,a){this.favIndex=a},changeSelect:function(){this.isSelect=!this.isSelect},changeFav:function(){this.isSelect_fav=!this.isSelect_fav},add:function(t){this.content=t;var a={title:this.title,cataIndex:this.cataIndex,content:this.content,favIndex:this.favIndex};""!==this.title.trim()&&""!==this.content.trim()&&localStorage.setItem("addData",JSON.stringify(a))},submit:function(){var t=this;return Object(n["a"])(Object(l["a"])().m((function a(){var e;return Object(l["a"])().w((function(a){while(1)switch(a.n){case 0:return a.n=1,t.$refs.observer.validate();case 1:if(e=a.v,e){a.n=2;break}return a.a(2);case 2:if(""!==t.content.trim()){a.n=3;break}return t.$alert("文章内容不得为空！"),a.a(2);case 3:Object(c["a"])({title:t.title,catalog:t.catalogs[t.cataIndex].value,content:t.content,fav:t.favList[t.favIndex],code:t.code,sid:t.$store.state.sid}).then((function(a){200===a.code?(localStorage.setItem("addData",""),t.$pop("","发贴成功!"),setTimeout((function(){t.$router.push({name:"detail",params:{tid:a.data._id}})}),2e3)):t.$alert(a.msg)}));case 4:return a.a(2)}}),a)})))()}},computed:{isHide:function(){return this.$store.state.isHide}}},d=u,v=e("2877"),f=Object(v["a"])(d,i,s,!1,null,"fe7d24e0",null);a["default"]=f.exports}}]);