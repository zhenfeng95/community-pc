(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["detail"],{"2e43":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("dl",{staticClass:"fly-panel fly-list-one"},[e("dt",{staticClass:"fly-panel-title"},[t._v("本周热议")]),t._l(t.lists,(function(a,i){return e("dd",{key:"hotlist"+i},[e("router-link",{attrs:{to:{name:"detail",params:{tid:a._id}}}},[t._v(t._s(a.title))]),e("span",[e("i",{staticClass:"iconfont icon-pinglun1"}),t._v(" "+t._s(a.answer)+" ")])],1)}))],2)])},s=[],n=a("cc48"),c={name:"hotlist",data:function(){return{lists:[]}},mounted:function(){var t=this;Object(n["f"])().then((function(e){200===e.code&&(t.lists=e.data)}))}},o=c,l=a("2877"),d=Object(l["a"])(o,i,s,!1,null,"52f37b14",null);e["a"]=d.exports},4634:function(t,e,a){},5539:function(t,e,a){"use strict";var i=function(){var t=this;t._self._c;return t._m(0)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"fly-panel"},[e("div",{staticClass:"fly-panel-title"},[t._v("在线课程")]),e("div",{staticClass:"fly-panel-main"},[e("a",{staticClass:"fly-zanzhu",staticStyle:{"background-color":"#5FB878"},attrs:{href:"https://class.imooc.com/sale/webfullstack?mc_marking=1eb5ce0be2ada8da4a6387b391f00b92&mc_channel=syzcjj1",target:"_blank"}},[t._v("大前端-更高层面进阶前端")]),e("a",{staticClass:"fly-zanzhu",staticStyle:{"background-color":"#5FB878"},attrs:{href:"https://www.imooc.com/learn/1091",target:"_blank"}},[t._v("3小时速成 Vue2.x 核心技术")])])])}],n={name:"ads"},c=n,o=a("2877"),l=Object(o["a"])(c,i,s,!1,null,"72d062e2",null);e["a"]=l.exports},"7aa9":function(t,e,a){"use strict";a("4634")},"923a":function(t,e,a){"use strict";a.r(e);a("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layui-container"},[e("imooc-panel"),e("div",{staticClass:"layui-row layui-col-space15"},[e("div",{staticClass:"layui-col-md8 content detail"},[e("div",{staticClass:"fly-panel detail-box"},[e("h1",[t._v(t._s(t.page.title))]),e("div",{staticClass:"fly-detail-info"},["share"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("分享")]):"ask"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("提问")]):"advise"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("建议")]):"logs"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("动态")]):"discuss"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("交流")]):"notice"===t.page.catalog?e("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("公告")]):t._e(),"0"===t.page.isEnd?e("span",{staticClass:"layui-badge",staticStyle:{"background-color":"#999"}},[t._v("未结")]):e("span",{staticClass:"layui-badge",staticStyle:{"background-color":"#5FB878"}},[t._v("已结")]),e("span",{directives:[{name:"show",rawName:"v-show",value:"1"===t.page.isTop,expression:"page.isTop === '1'"}],staticClass:"layui-badge layui-bg-black"},[t._v("置顶")]),t._l(t.page.tags,(function(a,i){return e("span",{key:"tags"+i,staticClass:"layui-badge",class:a.class},[t._v(t._s(a.name))])})),e("div",{directives:[{name:"hasRole",rawName:"v-hasRole",value:"admin",expression:"'admin'"}]},[e("div",{staticClass:"fly-admin-box",attrs:{"data-id":"123"}},[e("span",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["get","delete"],expression:"['get','delete']"}],staticClass:"layui-btn layui-btn-xs jie-admin",attrs:{type:"del"}},[t._v("删除")]),"0"===t.page.isTop?e("span",{staticClass:"layui-btn layui-btn-xs jie-admin",attrs:{type:"set",field:"stick",rank:"1"}},[t._v("置顶")]):e("span",{staticClass:"layui-btn layui-btn-xs jie-admin",staticStyle:{"background-color":"#ccc"},attrs:{type:"set",field:"stick",rank:"0"}},[t._v("取消置顶")])])]),e("span",{staticClass:"fly-list-nums"},[e("a",{attrs:{href:"#comment"}},[e("i",{staticClass:"iconfont",attrs:{title:"回答"}},[t._v("")]),t._v(" "+t._s(t.page.answer)+" ")]),e("i",{staticClass:"iconfont",attrs:{title:"人气"}},[t._v("")]),t._v(" "+t._s(t.page.reads)+" ")])],2),e("div",{staticClass:"detail-about"},[e("a",{staticClass:"fly-avatar",attrs:{href:"../user/home.html"}},[e("img",{attrs:{src:t.page.uid?t.page.uid.pic:"/img/bear-200-200.jpg"}})]),e("div",{staticClass:"fly-detail-user"},[e("a",{staticClass:"fly-link",attrs:{href:"../user/home.html"}},[e("cite",[t._v(t._s(t.page.uid?t.page.uid.name:"imooc"))]),t.page.uid&&"0"!==t.page.uid.isVip&&t.page.uid.isVip?e("i",{staticClass:"layui-badge fly-badge-vip mr1"},[t._v("VIP"+t._s(t.page.uid.isVip))]):t._e()]),e("span",[t._v(t._s(t._f("moment")(t.page.created)))])]),e("div",{staticClass:"detail-hits"},[e("span",{staticStyle:{"padding-right":"10px",color:"#FF7200"}},[t._v("悬赏："+t._s(t.page.fav))])])]),e("div",{staticClass:"layui-btn-container fly-detail-admin pt1"},[e("router-link",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.page.uid._id===t.user._id,expression:"page.isEnd === '0' && page.uid._id === user._id"}],staticClass:"layui-btn layui-btn-sm jie-admin",attrs:{to:{name:"edit",params:{tid:t.tid,page:t.page}}}},[t._v("编辑")]),e("a",{staticClass:"layui-btn layui-btn-sm jie-admin-collect",class:{"layui-btn-primary":t.page.isFav},on:{click:function(e){return e.preventDefault(),t.setCollect()}}},[t._v(t._s(t.page.isFav?"取消收藏":"收藏"))])],1),e("div",{staticClass:"detail-body photos",domProps:{innerHTML:t._s(t.content)}})]),e("div",{staticClass:"fly-panel detail-box",attrs:{id:"flyReply"}},[t._m(0),e("ul",{staticClass:"jieda",attrs:{id:"jieda"}},[t._l(t.comments,(function(a,i){return e("li",{key:"commments"+i,staticClass:"jieda-daan"},[e("div",{staticClass:"detail-about detail-about-reply"},[e("a",{staticClass:"fly-avatar",attrs:{href:""}},[e("img",{attrs:{src:a.cuid?a.cuid.pic:"/img/bear-200-200.jpg",alt:" "}})]),e("div",{staticClass:"fly-detail-user"},[e("router-link",{staticClass:"fly-link",attrs:{to:{name:"home",params:{uid:a.cuid?a.cuid._id:""}}}},[e("cite",[t._v(t._s(a.cuid?a.cuid.name:"imooc"))]),a.cuid&&"0"!==a.cuid.isVip&&a.cuid.isVip?e("i",{staticClass:"layui-badge fly-badge-vip"},[t._v("VIP"+t._s(a.cuid.isVip))]):t._e()]),0===i?e("span",[t._v("(楼主)")]):t._e()],1),e("div",{staticClass:"detail-hits"},[e("span",[t._v(t._s(t._f("moment")(a.created)))])]),e("i",{directives:[{name:"show",rawName:"v-show",value:"1"===a.isBest,expression:"item.isBest === '1'"}],staticClass:"iconfont icon-caina",attrs:{title:"最佳答案"}})]),e("div",{directives:[{name:"richtext",rawName:"v-richtext",value:a.content,expression:"item.content"}],staticClass:"detail-body jieda-body photos"}),e("div",{staticClass:"jieda-reply"},[e("span",{staticClass:"jieda-zan",class:{zanok:"1"===a.handed},attrs:{type:"zan"},on:{click:function(e){return t.hands(a)}}},[e("i",{staticClass:"iconfont icon-zan"}),e("em",[t._v(t._s(a.hands))])]),e("span",{attrs:{type:"reply"},on:{click:function(e){return t.reply(a)}}},[e("i",{staticClass:"iconfont icon-svgmoban53"}),t._v(" 回复 ")]),e("div",{staticClass:"jieda-admin"},[e("span",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.user&&a.cuid._id===t.user._id,expression:"page.isEnd ==='0' && user && item.cuid._id === user._id"}],on:{click:function(e){return t.editComment(a)}}},[t._v("编辑")]),e("span",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.user&&t.page.uid&&t.page.uid._id===t.user._id,expression:"page.isEnd ==='0' && user && page.uid && page.uid._id === user._id"}],staticClass:"jieda-accept",on:{click:function(e){return t.setBest(a)}}},[t._v("采纳")])])])])})),0===t.comments.length?e("li",{staticClass:"fly-none"},[t._v("消灭零回复")]):t._e()],2),e("imooc-page",{directives:[{name:"show",rawName:"v-show",value:t.comments.length>0&&t.total>0,expression:"comments.length > 0 && total > 0"}],attrs:{showType:"icon",hasSelect:!1,hasTotal:!1,total:t.total,size:t.size,current:t.current,showEnd:!0},on:{changeCurrent:t.handleChange,changeLimit:t.handleLimit}}),e("div",{staticClass:"layui-form layui-form-pane"},[e("form",[e("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(a){var i=a.validate;return[e("imooc-edit",{attrs:{initContent:t.editInfo.content},on:{changeContent:t.addContent}}),e("div",{staticClass:"layui-form-item"},[e("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.errors;return[e("div",{staticClass:"layui-row"},[e("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),e("div",{staticClass:"layui-input-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),e("div",{},[e("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(e){return t._getCode()}}})])]),e("div",{staticClass:"layui-form-mid"},[e("span",{staticStyle:{color:"#c00"}},[t._v(t._s(i[0]))])])]}}],null,!0)})],1),e("div",{staticClass:"layui-form-item"},[e("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(e){i().then(t.submit)}}},[t._v("提交回复")])])]}}])})],1)])],1)]),e("div",{staticClass:"layui-col-md4"},[e("imooc-hotlist"),e("imooc-ads"),e("imooc-links")],1)])],1)},s=[function(){var t=this,e=t._self._c;return e("fieldset",{staticClass:"layui-elem-field layui-field-title",staticStyle:{"text-align":"center"}},[e("legend",[t._v("回帖")])])}],n=a("c14f"),c=a("5530"),o=a("1da1"),l=(a("99af"),a("14d9"),a("a434"),a("ac1f"),a("00b4"),a("5319"),a("498a"),a("cc48")),d=a("b775"),r=a("4328"),u=a.n(r),f=a("c0d6"),p=function(t){var e=f["a"].state.token,a={};return""!==e&&(a={headers:{Authorization:"Bearer "+f["a"].state.token}}),d["a"].get("/public/comments?"+u.a.stringify(t),a)},m=function(t){return d["a"].post("/comments/reply",Object(c["a"])({},t))},v=function(t){return d["a"].post("/comments/update",Object(c["a"])({},t))},g=function(t){return d["a"].get("/comments/accept?"+u.a.stringify(t))},h=function(t){return d["a"].get("/comments/hands?"+u.a.stringify(t))},y=a("c24f"),_=a("2e43"),b=a("5539"),C=a("dec8"),k=a("9c97"),w=a("32d8"),j=a("81b3"),I=a("4ebd"),x=a("8b77"),$=a("cf45"),E={name:"Detail",mixins:[j["a"]],props:["tid"],components:{"imooc-hotlist":_["a"],"imooc-ads":b["a"],"imooc-links":C["a"],"imooc-panel":k["a"],"imooc-edit":w["a"],"imooc-page":I["a"]},data:function(){return{total:0,size:10,current:0,page:{},comments:[],editInfo:{content:"",code:"",sid:""}}},mounted:function(){this.getPostDetail(),this.getCommentsList()},watch:{tid:function(t,e){this.getPostDetail(),this.getCommentsList()}},methods:{handleChange:function(t){this.current=t,this.getCommentsList()},handleLimit:function(t){this.size=t,this.getCommentsList()},getPostDetail:function(){var t=this;Object(l["b"])(this.tid).then((function(e){200===e.code&&(t.page=e.data)}))},getCommentsList:function(){var t=this;p({tid:this.tid,page:this.current,limit:this.size}).then((function(e){200===e.code&&(t.comments=e.data,t.total=e.total)}))},addContent:function(t){this.editInfo.content=t},submit:function(){var t=this;return Object(o["a"])(Object(n["a"])().m((function e(){var a,i,s,o,l;return Object(n["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.$refs.observer.validate();case 1:if(a=e.v,a){e.n=2;break}return e.a(2);case 2:if(i=t.$store.state.isLogin,i){e.n=3;break}return t.$pop("shake","请先登录"),e.a(2);case 3:if(s=t.$store.state.userInfo,"0"===s.status){e.n=4;break}return t.$pop("shake","用户已经禁言，请联系管理员"),e.a(2);case 4:if(t.editInfo.code=t.code,t.editInfo.sid=t.$store.state.sid,t.editInfo.tid=t.tid,o={_id:s._id,pic:s.pic,name:s.name,isVip:s.isVip},"undefined"===typeof t.editInfo.cid||""===t.editInfo.cid){e.n=6;break}if(l=Object(c["a"])({},t.editInfo),delete l["item"],t.editInfo.content!==t.editInfo.item.content){e.n=5;break}return t.$pop("shake","确定编辑了内容~~~"),e.a(2);case 5:return v(l).then((function(e){if(200===e.code){var a=t.editInfo.item;a.content=t.editInfo.content,t.$pop("","更新评论成功"),t.code="",t.editInfo.content="",t.comments.splice(t.comments.indexOf(t.editInfo.item),1,a)}})),e.a(2);case 6:m(t.editInfo).then((function(e){200===e.code?(t.$pop("","发表评论成功"),t.code="",t.editInfo.content="",e.data.cuid=o,t.comments.push(e.data),requestAnimationFrame((function(){t.$refs.observer&&t.$refs.observer.reset()})),t._getCode()):t.$alert(e.msg)}));case 7:return e.a(2)}}),e)})))()},editComment:function(t){this.editInfo.content=t.content,Object($["b"])(".layui-input-block",500,-65),document.getElementById("edit").focus(),this.editInfo.cid=t._id,this.editInfo.item=t},setBest:function(t){var e=this;this.$confirm("确定采纳为最佳答案吗?",(function(){g({cid:t._id,tid:e.tid}).then((function(a){200===a.code&&(e.$pop("","设置最佳答案成功！"),t.isBest="1",e.page.isEnd="1")}))}),(function(){}))},hands:function(t){var e=this;h({cid:t._id}).then((function(a){200===a.code?(e.$pop("","点赞成功"),t.handed="1",t.hands+=1):e.$pop("shake",a.msg)}))},reply:function(t){var e=/^@[\S]+/g;this.editInfo.content?e.test(this.editInfo.content)?this.editInfo.content=this.editInfo.content.replace(e,"@"+t.cuid.name+" "):""!==this.editInfo.content&&(this.editInfo.content="@".concat(t.cuid.name," ").concat(this.editInfo.content)):this.editInfo.content="@"+t.cuid.name+" ",Object($["b"])(".layui-input-block",500,-65),document.getElementById("edit").focus()},setCollect:function(){var t=this,e=this.$store.state.isLogin;if(e){var a={tid:this.tid,title:this.page.title,isFav:this.page.isFav?1:0};Object(y["a"])(a).then((function(e){200===e.code&&(t.page.isFav=!t.page.isFav,t.$pop("",t.page.isFav?"设置收藏成功":"取消收藏成功"))}))}else this.$pop("shake","请先登录后再进行收藏！")}},computed:{content:function(){return"undefined"===typeof this.page.content||""===this.page.content.trim()?"":Object(x["a"])(this.page.content)},user:function(){return this.$store.state.userInfo}}},O=E,B=(a("7aa9"),a("2877")),F=Object(B["a"])(O,i,s,!1,null,"7e225422",null);e["default"]=F.exports},dec8:function(t,e,a){"use strict";a("9911");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"fly-panel fly-link"},[e("h3",{staticClass:"fly-panel-title"},[t._v("友情链接")]),e("dl",{staticClass:"fly-panel-main"},[t._l(t.lists,(function(a,i){return e("dd",{key:"links"+i},[e("a",{attrs:{href:a.link,target:"_blank"}},[t._v(t._s(a.title))])])})),e("dd"),t._m(0),e("dd")],2)])},s=[function(){var t=this,e=t._self._c;return e("dd",[e("a",{staticClass:"fly-link",attrs:{href:"mailto:brian@toimc.com?subject=%E7%94%B3%E8%AF%B7Fly%E7%A4%BE%E5%8C%BA%E5%8F%8B%E9%93%BE"}},[t._v("申请友链")])])}],n=a("cc48"),c={name:"links",data:function(){return{lists:[]}},mounted:function(){var t=this;Object(n["c"])().then((function(e){200===e.code&&(t.lists=e.data)}))}},o=c,l=a("2877"),d=Object(l["a"])(o,i,s,!1,null,"751758fa",null);e["a"]=d.exports}}]);