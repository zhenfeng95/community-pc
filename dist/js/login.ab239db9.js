(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{2366:function(t,e){for(var a=[],s=0;s<256;++s)a[s]=(s+256).toString(16).substr(1);function r(t,e){var s=e||0,r=a;return[r[t[s++]],r[t[s++]],r[t[s++]],r[t[s++]],"-",r[t[s++]],r[t[s++]],"-",r[t[s++]],r[t[s++]],"-",r[t[s++]],r[t[s++]],"-",r[t[s++]],r[t[s++]],r[t[s++]],r[t[s++]],r[t[s++]],r[t[s++]]].join("")}t.exports=r},5699:function(t,e,a){},"7ded":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return u}));var s=a("5530"),r=a("b775"),i=function(t){return r["a"].get("/public/getCaptcha",{params:{sid:t}})},o=function(t){return r["a"].post("/login/forget",Object(s["a"])({},t))},n=function(t){return r["a"].post("/login/login",Object(s["a"])({},t))},l=function(t){return r["a"].post("/login/reg",Object(s["a"])({},t))},u=function(t){return r["a"].post("/login/reset",Object(s["a"])({},t))}},"80cd":function(t,e,a){"use strict";a("5699")},a55b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layui-container fly-marginTop"},[e("div",{staticClass:"fly-panel fly-panel-user",attrs:{pad20:""}},[e("div",{staticClass:"layui-tab layui-tab-brief",attrs:{"lay-filter":"user"}},[e("ul",{staticClass:"layui-tab-title"},[e("li",{staticClass:"layui-this"},[t._v("登入")]),e("li",[e("router-link",{attrs:{to:{name:"reg"}}},[t._v("注册")])],1)]),e("div",{staticClass:"layui-form layui-tab-content",staticStyle:{padding:"20px 0"},attrs:{id:"LAY_ucm"}},[e("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(a){var s=a.validate;return[e("div",{staticClass:"layui-tab-item layui-show"},[e("div",{staticClass:"layui-form layui-form-pane"},[e("form",{attrs:{method:"post"}},[e("div",{staticClass:"layui-form-item"},[e("label",{staticClass:"layui-form-label",attrs:{for:"L_email"}},[t._v("用户名")]),e("validation-provider",{attrs:{name:"email",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("div",{staticClass:"layui-input-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"layui-input",attrs:{type:"text",name:"username",placeholder:"请输入用户名",autocomplete:"off"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"layui-form-mid"},[e("span",{staticStyle:{color:"#c00"}},[t._v(t._s(s[0]))])])]}}],null,!0)})],1),e("div",{staticClass:"layui-form-item"},[e("label",{staticClass:"layui-form-label",attrs:{for:"L_pass"}},[t._v("密码")]),e("validation-provider",{attrs:{name:"password",rules:"required|min:6"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("div",{staticClass:"layui-input-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"layui-input",attrs:{type:"password",name:"password",placeholder:"请输入密码",autocomplete:"off"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("div",{staticClass:"layui-form-mid"},[e("span",{staticStyle:{color:"#c00"}},[t._v(t._s(s[0]))])])]}}],null,!0)})],1),e("div",{staticClass:"layui-form-item"},[e("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors;return[e("div",{staticClass:"layui-row"},[e("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),e("div",{staticClass:"layui-input-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),e("div",{},[e("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(e){return t._getCode()}}})])]),e("div",{staticClass:"layui-form-mid"},[e("span",{staticStyle:{color:"#c00"}},[t._v(t._s(s[0]))])])]}}],null,!0)})],1),e("div",{staticClass:"layui-form-item"},[e("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(e){s().then(t.submit)}}},[t._v("立即登录")]),e("span",{staticStyle:{"padding-left":"20px"}},[e("router-link",{attrs:{to:{name:"forget"}}},[t._v("忘记密码？")])],1)]),e("div",{staticClass:"layui-form-item fly-form-app"},[e("span",[t._v("或者使用社交账号登入")]),e("a",{staticClass:"iconfont icon-qq",attrs:{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",title:"QQ登入"}}),e("a",{staticClass:"iconfont icon-weibo",attrs:{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",title:"微博登入"}})])])])])]}}])})],1)])])])},r=[],i=a("c14f"),o=a("1da1"),n=(a("14d9"),a("7bb1")),l=a("7ded"),u=a("c64e"),c=a.n(u),d={name:"login",components:{ValidationProvider:n["b"],ValidationObserver:n["a"]},data:function(){return{username:"",password:"",code:"",svg:""}},mounted:function(){var t="";localStorage.getItem("sid")?t=localStorage.getItem("sid"):(t=c()(),localStorage.setItem("sid",t)),this.$store.commit("setSid",t),this._getCode()},methods:{_getCode:function(){var t=this,e=this.$store.state.sid;Object(l["b"])(e).then((function(e){0===e.code&&(t.svg=e.data)}))},submit:function(){var t=this;return Object(o["a"])(Object(i["a"])().m((function e(){var a;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.$refs.observer.validate();case 1:if(a=e.v,a){e.n=2;break}return e.a(2);case 2:Object(l["c"])({username:t.username,password:t.password,code:t.code,sid:t.$store.state.sid}).then((function(e){if(0===e.code){e.data.username=t.username,t.$store.commit("setUserInfo",e.data),t.$store.commit("setIsLogin",!0),t.$store.commit("setToken",e.token),localStorage.setItem("refreshToken",e.refreshToken),t.username="",t.password="",t.code="",requestAnimationFrame((function(){t.$refs.observer&&t.$refs.observer.reset()}));var a=t.$route.query.redirect||{name:"index"};t.$router.push(a)}else 0!==e.code&&t.$refs.codefield.setErrors([e.msg])})).catch((function(e){var a=e.response.data;500===a.code?t.$alert("用户名密码校验失败，请检查！"):t.$alert("服务器错误")}));case 3:return e.a(2)}}),e)})))()}}},f=d,m=(a("80cd"),a("2877")),p=Object(m["a"])(f,s,r,!1,null,"d467d218",null);e["default"]=p.exports},c64e:function(t,e,a){var s=a("e1f4"),r=a("2366");function i(t,e,a){var i=e&&a||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var o=t.random||(t.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var n=0;n<16;++n)e[i+n]=o[n];return e||r(o)}t.exports=i},e1f4:function(t,e){var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(a){var s=new Uint8Array(16);t.exports=function(){return a(s),s}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}}}]);